<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>librsb: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librsb
   &#160;<span id="projectnumber">1.3.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">librsb Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A sparse matrix library implementing the `Recursive Sparse Blocks' (<b>RSB</b>) matrix storage.</p>
<p>This is the documentation for the application programming interface (API) of the <em>`<code>librsb'</code> library</em>. <br />
In order to use <code>librsb</code>, there is no need for the user to know the RSB layout and algorithms: this documentation should be sufficient. <br />
<code>librsb</code> is dual-interfaced; it supports: a native (`RSB') interface (with identifiers prefixed by `rsb_' or `RSB_'), and a (mostly complete) Sparse BLAS interface, as a wrapper around the RSB interface. <br />
Many computationally intensive operations are implemented with thread parallelism, by using OpenMP. <br />
Thread parallelism can be turned off at configure time, if desired, or controlled at execution time. <br />
Many of the computational kernels source code files (mostly internals) were automatically generated. <br />
This user documentation concerns the end user API only. <br />
 This library was born as <b>research</b> <b>software</b>. <br />
Over the years it has been stabilized and its <b>test</b> <b>suite</b> expanded considerably. <br />
There are projects making available <code>librsb</code> in Octave, Python or Julia; you might want to check them out as well.</p>
<p><br />
For a first approach, see the <a class="el" href="group__rsb__doc__examples.html">Example programs and code</a> documentation section, or the <a class="el" href="index.html#examples_section">quick start examples</a> section on this page.</p>
<p><br />
Information about the supported matrix types and matrix operations resides in the <a class="el" href="rsb__types_8h.html">rsb_types.h </a> file.</p>
<p>A C/C++ user can use the native API of RSB by including the <a class="el" href="rsb_8h.html">rsb.h </a> header. <br />
The same interface is available in Fortran via the ISO C Binding interface, specified in <a class="el" href="rsb_8F90.html">rsb.F90</a>. <br />
An <b>experimental</b> <b>C++</b> API is available in (optional) <a class="el" href="rsb_8hpp.html">rsb.hpp</a>. <br />
 The C header file for <a class="el" href="group__rsb__doc__sparse__blas.html">The Sparse BLAS interface to librsb (blas_sparse.h, rsb_blas_sparse.F90)</a> is <a class="el" href="blas__sparse_8h.html">blas_sparse.h</a> (notice there is no native C++ equivalent).</p>
<dl class="section author"><dt>Author</dt><dd>Michele Martone &lt; michelemartone AT users DOT sourceforge DOT net &gt;</dd></dl>
<p>Contents of the README file : </p><pre class="fragment">
librsb README file
================================================================================


librsb - Recursive Sparse Blocks  Matrix computations library
--------------------------------------------------------------------------------

 A library for sparse matrix computations featuring the Recursive Sparse Blocks
 (RSB) matrix format, geared towards cache efficient and multi-threaded
 (that is, shared memory parallel) operations on large sparse matrices.
 It provides the most common operations necessary to iterative solvers, like
 matrix-vector and matrix-matrix multiplication, triangular solution, scaling of
 rows/columns, diagonal extraction / setting, blocks extraction, computation of
 norm, formats conversion.
 The RSB format is especially well suited for symmetric and transposed 
 multiplication variants.
 Much of the source code is machine-generated; the supported numerical types can
 be chosen by the user at build time.
 This library is dual-interfaced: it can be used via the native (`RSB`) 
 interface (with function identifiers prefixed by `rsb_` or `RSB_`), and a 
 Sparse BLAS one (function identifiers prefixed by `BLAS_`).
 The `RSB` interface can be used from C/C++ (`rsb.h` header) or via modern 
 Fortran ISO-C-BINDING (`rsb` module in `rsb.F90`).
 New in version 1.3 is the C++-only API in `rsb.hpp` (`Rsb`-prefixed classes).
 The Sparse BLAS interface is usable from C/C++ via the `blas_sparse.h` header, 
 and from Fortran via the `blas_sparse` module.


--------------------------------------------------------------------------------

 This (README) is the first document you should read about librsb.
 It contains basic instructions to configure, build, install, and use librsb.
 The reference documentation for programming with librsb is contained in the
 `./doc/` source package subdirectory and when installed, placed in the
 appropriate system directories as both Unix man pages (`./doc/man/`) and HTML
 (`./doc/html/`).
 If you have used a previous release version of librsb, see the `NEWS` file 
 for a succinct list of user-relevant changes.


INTRODUCTION
--------------------------------------------------------------------------------

 librsb is a library for sparse matrix algebra computations.
 It is stand-alone: it does not require any other library to build or work.
 It is shared memory parallel, using constructs from the OpenMP standard.
 It is focused on high performance SpMV and SpMM operations.
 A part of the library code is automatically generated from templates and
 macros, on the basis of the numerical types a user wishes to have supported.
 The configure script provides many build time options, especially with respect
 to debug and additional verbosity (see `configure --help`).
 Defaults should be fine for most users, though.

 - INTRODUCTION
 - MAIN ASPECTS,FEATURES
 - QUICK INSTALL AND TESTING EXAMPLE
 - LIBRARY CONFIGURATION, GENERATION, BUILD 
 - INSTALLATION, USAGE
 - EXECUTION AND ENVIRONMENT VARIABLES
 - DOCUMENTATION, EXAMPLES AND PROGRAMMING GUIDELINES
 - CONFIGURE, BUILD AND BENCHMARK EXAMPLE
 - COMPATIBILITY
 - FAQ
 - POSSIBLE FUTURE ENHANCEMENTS
 - ABOUT THE INTERNALS
 - BUGS
 - CONTACTS
 - CREDITS
 - LICENSE


MAIN ASPECTS,FEATURES
--------------------------------------------------------------------------------

 * conceived for efficient multithreaded SpMV/SpMM
 * thread level (shared memory) parallelism by using OpenMP
 * threads/structure auto-tuning feature for additional performance
 * support for multiple numerical data types which can be turned
   on/off individually (e.g.:`double`, `float`, `int`, `char`, `float complex`, 
   `double complex`) at configure time
 * a Sparse BLAS interface for matrix assembly, computation, destruction
 * code generators for the inner CSR, COO computational kernels
 * based on a recursive memory layout of submatrices
 * enough functionality to implement the most common iterative methods 
 * basic input sanitizing (index types overflow checks, etc)
 * parallel matrix assembly and conversion routines
 * auxiliary functions for matrix I/O (using the "Matrix Market" format:
   real, integer, complex and pattern are supported)
 * implemented as a building block for solvers like e.g. PSBLAS, MaPHyS++
 * dual implementation of inner kernels: with "full-" and "half-word" indices
 * basic (unoptimized) sparse matrices multiplication and summation
 * interactive usage possible by using the `sparsersb` plugin for GNU Octave 
   or the PyRSB Python package
 * complete with examples and a test suite
 * see the `NEWS` text file for a detailed list of changes in each release


QUICK INSTALL AND TESTING EXAMPLE
--------------------------------------------------------------------------------

	# unpack the archives or get them from the repositories
	./autogen.sh	# only necessary if  configure  file does not exist
	./configure --prefix=$HOME/local/librsb/ # with installation destination
        # see also ./configure --help for many other options
        # see      ./configure --help=recursive for even more options
	# librsb has been configured
	make help	# provide information
	make		# build the library and test programs
	# librsb has been built
        make  qtests	# perform brief sanity tests
        make qqtests	# the same, but with less output
        make   tests	# perform extended sanity tests
	ls examples/*.c   # editable C       examples; build them with 'make'
	ls examples/*.cpp # editable C++     examples; build them with 'make'
	ls examples/*.F90 # editable Fortran examples; build them with 'make'
	make install	# install to $HOME/local/librsb/
	make itests     # perform post-installation tests on examples
	# librsb has been installed and can be used

	# for instance, try using one of the librsb examples as a base:
	mkdir -p ~/rsb-test/ &amp;&amp; cp examples/hello.c ~/rsb-test/myrsb.c
	# adapt hello.c to your needs and recompile:
	cd ~/rsb-test/
	export PATH=$PATH:$HOME/local/librsb/bin/
	gcc `librsb-config --I_opts`.  -c myrsb.c 
 	gcc -o myrsb myrsb.o `librsb-config --static --ldflags --extra_libs`
 	./myrsb         # run your program


LIBRARY CONFIGURATION, GENERATION, BUILD
--------------------------------------------------------------------------------

 A good portion of this library is C code generated via M4 preprocessor macros.
 Certain generation options (notably, supported numerical types) can be set via
 the `./configure`  script.
 The location of the M4 executable can be specified via `./configure M4=...`
 After invoking `./configure` and before running `make` it is possible to invoke
 `make cleanall` to make sure that auto-generated code is deleted first.
 
 The `configure` script attempts at detecting the system cache memory hierarchy
 parameters and prints them out.
 If detection fails, you can pass them via the `--with-memhinfo=...`  option.
 For instance, declaring having 3 MB of L3, 256 kB of L2, and 32 kB of L1:
    `./configure --with-memhinfo="L3:12/64/3072K,L2:8/64/256K,L1:8/64/32K" `
 These values need not be exact: also approximate can help achieving better
 performance.
 You can override the configure-time default at run time: see API documentation.
 Read a few sections further for a description of the memory hierarchy info
 string format.

 If you want to enable Fortran examples, be sure of running `./configure` with
 the `--enable-fortran-examples` option.  You can specify the desired Fortran
 compiler and compilation flags via the `FC` and `FCFLAGS` variables.

 Set the `CPPFLAGS` variable at configure time to provide additional compilation
 flags; e.g. `configure` to detect necessary headers in non-standard location.
 Similarly, the `LDFLAGS` variable can be set to contain link time options; so
 you can use it to specify libraries to be linked to librsb examples.
 Invoke `./configure --help` for details of other relevant environment
 variables.
 
 The `./configure` script will emit information about the current build options.
 If all went fine, you can invoke `make` to build the library and the examples.

 To check for library consistency, run:

	make qtests # takes a short time, spots most problems
or

	make tests  # takes longer, qtests is usually enough
 
 If these tests terminate with an error code, it may be that it has been caused
 by a bug in librsb, so please report it (see BUGS).
 These tests also check error reporting capabilities, so don't be scared by 
 error messages appearing in the running output.


INSTALLATION, USAGE
--------------------------------------------------------------------------------
 
 Once built, the library can be installed with e.g.:

	sudo make install	# 'sudo' may be needed for system-wide locations

 This installs header files, binary library files, documentation, examples,
 and the `librsb-config` program.
 Then, application C programs should include the `rsb.h` header file with
 `#include &lt;rsb.h&gt;`
 C++ programs can use that as well, or `#include &lt;rsb.hpp&gt;`.
 Path to the librsb headers and extra options can be obtained via
 `librsb-config --I_opts`.

 To link to the librsb library and its dependencies one can use the output of
 `librsb-config --static --ldflags --extra_libs`.
 
 Users of `pkg-config` can manually copy the `librsb.pc` file to the appropriate
 directory to use `pkg-config` in a way similar to `librsb-config`.


EXECUTION AND ENVIRONMENT VARIABLES
--------------------------------------------------------------------------------
 
 By default, librsb reads the environment variable
 `RSB_USER_SET_MEM_HIERARCHY_INFO`, which allows to override settings of memory
 hierarchy set at configure-time or detected at runtime.

 Its value is specified as n concatenated strings of the form:

	L&lt;l&gt;:&lt;a_l&gt;/&lt;b_l&gt;/&lt;c_l&gt;

 These strings are separated by a comma (","), and each of them is made
 up from substrings where:

	&lt;n&gt; is the cache memories hierarchy height, from 1 upwards.
	&lt;l&gt; is the cache level, from 1 upwards.
	&lt;a_l&gt; is the cache associativity
	&lt;b_l&gt; is the cache block size (cache line length)
	&lt;c_l&gt; is the cache capacity (size)

 The `&lt;a_l&gt;`, `&lt;b_l&gt;`, `&lt;c_l&gt;` substrings consist of an integer number with an
 optional multiplier character among {K,M,G} (to specify respectively 2^10,
 2^20 or 2^30).
 Any value is permitted, a long as it is positive. Higher level cache
 capacities are required to be larger than lower level ones.
 Please note that currently, only the cache capacity value is being used.
 Example strings and usage in the BASH shell:

	RSB_USER_SET_MEM_HIERARCHY_INFO="L2:4/64/512K,L1:8/64/32K"  &lt;your program&gt;
	RSB_USER_SET_MEM_HIERARCHY_INFO="L1:8/128/2M"  &lt;your program&gt;

 Experimenting with this environment variable can help tuning performance.

 Setting this environment variable may be also needed if automatic detection
 fails (e.g. very recent systems).

 A default value for this memory hierarchy info string can be set at configure
 time by using the  `--with-memhinfo`  configure option.

 If you don't know values for these parameters, you can run the
 `./scripts/linux-sys-cache.sh`
 script to try to get a guess on a Linux system.
 On other systems, please consult the available documentation.
 E.g.: On Mac OS 10.6 it was possible to get this information by invoking
  `sysctl -a | grep cache`.
  
 You can control the active threads count with OpenMP variable 
 `OMP_NUM_THREADS`, but also override it via `RSB_NUM_THREADS`.


DOCUMENTATION, EXAMPLES AND PROGRAMMING GUIDELINES
--------------------------------------------------------------------------------

 The `&lt;rsb.h&gt;` header file specifies the C API of librsb.
 Header `&lt;rsb.hpp&gt;` provides two C++ classes for librsb and most of the
 functionality of `&lt;rsb.h&gt;`.
 So these two files are good starting points to learn to use librsb.
 
 To generate librsb API documentation, you need to run configure with the
 `--enable-doc-build` option. This requires the `doxygen` tool.
 Documentation will be placed in `doc/man/` and `doc/html`, and then
 installed with `make install`.
 Once installed and indexed, librsb man pages can be listed with
 `apropos rsb` or `man -k rsb`.

 The latest API documentation can also be found on http://librsb.sourceforge.net

 The `examples` directory has a number of working example programs.

 The library declares symbols prefixed by `rsb_`.
 To avoid name clashes, you should avoid declaring identifiers prefixed that way
 in programs using librsb.

 If `configure` has been invoked with the `--enable-sparse-blas-interface`, then
 the corresponding `BLAS_`- and `blas_`- prefixed symbols will also be built.


CONFIGURE, BUILD AND BENCHMARK EXAMPLE
--------------------------------------------------------------------------------

 The performance-critical parts of librsb are written in C and C++.
 Compilation flags for C and C++ are specified by the CFLAGS and CXXFLAGS
 variables
 Fortran flags can be set by FCFLAGS, but are of minor importance.
 A sensible setup can be:

	./configure CC=gcc CFLAGS='-Ofast' CXX=g++ CXXFLAGS='-Ofast -std=c++17' FC=gfortran --prefix=/opt/librsb

 You should be able to specify other combination of compilers, like icx+icpx+ifc
 or icc+icpc+ifort. If you have luck, even mix compilers from different suites.

 If you wish to build the librsb benchmark program with the MKL library (say,
 for performance comparison purposes), you can use one of the following three
 recipes as a base.

 With gcc, 64 bit (and a few more options you may want to adapt):

	export MKLROOT=/opt/intel/mkl
	./configure \
	  CC=gcc CFLAGS='-Ofast' \
	  CXX=g++ CXXFLAGS='-Ofast -std=c++17'         \
          FC=gfortran \
	  --with-mkl="-static -L${MKLROOT}/lib/intel64 \
	  -Wl,--start-group,-lmkl_intel_lp64,-lmkl_gnu_thread,-lmkl_core,--end-group \
	  -fopenmp -lpthread"                        \
	  --with-memhinfo=L2:4/64/512K,L1:8/64/24K   \
	  --with-mkl-include=/opt/intel/mkl/include/

 With icc, 64 bit)

	export MKLROOT=/opt/intel/mkl
	./configure \
	  CC=icc CFLAGS='-Ofast' \
	  CXX=icpc CXXFLAGS='-Ofast -std=c++17'    \
          FC=ifort \
	--with-mkl="-static -L${MKLROOT}/lib/intel64 -openmp -lpthread \
	-Wl,--start-group,-lmkl_intel_lp64,-lmkl_intel_thread,-lmkl_core,--end-group" \
	--with-memhinfo=L2:4/64/512K,L1:8/64/24K   \
	--with-mkl-include=/opt/intel/mkl/include/

  or 32 bit:

	./configure \
	  CC=gcc  CFLAGS='-Ofast'
	  CXX=g++ CXXFLAGS='-Ofast -std=c++17'        \
          FC=gfortran \
	 --with-memhinfo=L2:4/64/512K,L1:8/64/24K     \
	 --with-mkl="-static -L/opt/intel/mkl/lib/ia32/ -lmkl_solver \
	 -Wl,--start-group,-lmkl_intel,-lmkl_gnu_thread,-lmkl_core,--end-group \
	 -fopenmp -lpthread" \
	 --with-mkl-include=/opt/intel/mkl/include/

Once you chose your configure options, you want to build.

	make cleanall # (optional) delete generated sources
	make          # build library, documentation, tests, examples
	make qtests   # optional
	make install  # optional
	make itests   # optional

If you modified configure options impacting code generation, may want to run
`make cleanall`, which deletes stale sources and ensures sources re-generation
before the 'make'.

To speed up 'make', consider using the parallelism option, e.g.:

	make -j 3     # use 3 build threads

 After the build, say you want to benchmark the library for SpMV/SpMM.
 You have a Matrix Market file representing a matrix, `A.mtx`,
 you want to use 1 and 4 cores, and type Z (double complex).
 With SpMV, and SpMM with 2 right hand sides laid in C order.
 Then running:

	./rsbench -oa -Ob --bench -f A.mtx -qH -R -n1,4 -T z --verbose --nrhs 1,2 --by-rows

 will output performance and timing results in a tabular form.

 If not specifying a type (argument to the `-T` option), all will be used.
 If configured in at build time, choices may be `-T D` (where `D` is the BLAS
 prefix for `double`), `-T Z` (`Z` stands for `double complex`) and so on.
 You can also pass `-T :` to specify all of the configured types.

 For more options and configuration information, invoke:

	./rsbench -oa -Ob --help
	./rsbench --help
	./rsbench --version
	./rsbench -I
	./rsbench -C

 An example Matrix Market matrix file contents:

	%%MatrixMarket matrix coordinate pattern general
	% This is a comment.
	% See other examples in the distributed *.mtx files.
	2 2 3
	1 1
	2 1
	2 2


COMPATIBILITY
--------------------------------------------------------------------------------

 This library was developed mostly on Debian Linux and using only free software.
 
 This library has been built and tested on Unix machines.
 Microsoft Windows users can try building librsb under the Cygwin environment.

 (Ancient comment kept for the nostalgic reader)
 Some tricks may have to be used on IBM AIX. For instance, adding the
 `--without-xdr` or the `--without-zlib` switch to `./configure`.
 Your mileage may vary.
 AIX's `make` program may give problems; use the GNU version `gmake` instead;
 the same shall be done with the M4 interpreter.


FAQ
--------------------------------------------------------------------------------

 Q: **Can you provide me good configure defaults for an optimized build ?**

 A: Default `./configure` options are appropriate for an optimized build.
    A good starting point for `gcc` is `./configure CC=gcc CFLAGS='-O3'`. 
    However, if you need complex arithmetic and are using GCC, I'd advise using
    -Ofast. On many versions of GCC I observed sub-optimal complex arithmetic
    performance with `-O3`, regardless use of e.g. `-mtune=native`.
    For more, consult your compiler documentation (e.g. `man gcc`, `man icx`, 
    `man icc`),
    and learn about the best flags for your specific platform.
    Striping your executable (`make install-strip` for librsb's `rsbench`) may
    help.


 Q: **I am a beginner and I wish librsb to be very verbose when I invoke
    library interface functions incorrectly.
    Can you provide me good configure defaults for such a "debug" build ?**

 A: Yes: via the `./scripts/configure_for_debug.sh` script.


 Q: **I have problems linking, seems like some Fortran library is missing. 
    What should I do?**

 A: Did you try `./configure --enable-fortran-linker` ?


 Q: **I have machine X, compiler Y, compiling flags Z; is SpMV performance P 
    with matrix M good ?**

 A: In general, hard to tell. You can `make hinfo.log` and send to me (see
    CONTACTS) the `hinfo.log` file and your matrix in Matrix Market format
    (well, please don't send matrices by email but rather upload them
    somewhere on the web and send an URL to them).
    The `hinfo.log` file will contain useful compile and machine information.
    Then I *may* get an idea about the performance you should get with that
    matrix on that computer.


 Q: **What is the Sparse BLAS ?**

 A: It's a programming interface specification:

 * [sparseblas_2001]:
   BLAS Technical Forum Standard, Chapter 3, Sparse BLAS.
   http://www.netlib.org/blas/blast-forum/chapter3.pdf

 * [dhp_2002]:
   An Overview of the Sparse Basic Linear Algebra Subprograms:
    The New Standard from the BLAS Technical Forum.
   IAIN S. DUFF, CERFACS and Rutherford Appleton Laboratory.
   MICHAEL A. HEROUX, Sandia National Laboratories.
   ROLDAN POZO, National Institute of Standards and Technology.

 * [dv_2002]:
   Algorithm 818:
    A Reference Model Implementation of the Sparse BLAS in Fortran 95.
   IAIN S. DUFF, CERFACS, France and Atlas Centre, RAL, England.
   CHRISTOF VÖMEL, CERFACS, France.


 Q: **Is there an easy way to profile librsb usage in my application ?**

 A: Yes: build with `--enable-librsb-stats` and extract time elapsed in librsb
    via e.g.:`rsb_lib_get_opt(RSB_IO_WANT_LIBRSB_ETIME,&amp;etime);`.


 Q: **Why another sparse matrix library ?**

 A: This library is the fruit of the author's PhD work, focused on researching
    improved multi threaded and cache friendly matrix storage schemes for e.g.
    PSBLAS.


 Q: **What are the key features of this library when compared to other ones ?**

 A: Recursive storage, a code generator, parallel BLAS operations
    (including matrix assembly, matrix-matrix multiplication, transposed
     matrix-vector multiply), a rich test suite, a Sparse BLAS
     interface and a free software licensing.
 

 Q: **How do I detect librsb from my package's `configure` script ?**

 A: Please check out `examples/configure.ac` and `examples/makefile.am`:


 Q: **How is correctness checked in the librsb test suite ?**

 A: In different ways, often configuration dependent.
    Check out the `qtests` and `tests` targets in the Makefile.

 Q: **Why did you originally write the library in C and not in C++ ?**

 A: C is pretty easy to interface with C++ and Fortran.
    Using a debugger in C++ can be a headache.
    Also C's `restrict` keyword.
    

 Q: **Why did you use C and not Fortran ?**

 A: This library is slightly system-oriented, and system calls interfacing is
    much easier in C. Also C's pointer arithmetic was desirable.


 Q: **Is there a quick and easy way to perform an artificial performance
    test with huge matrices without having to program ?**

 A: Express your matrix in a Matrix Market format as the `A.mtx` file and
    use it as e.g.:**

	./rsbench -oa -Ob --bench -f A.mtx --verbose --nrhs 1,4 --by-rows


 Q: **I've found a bug! What should I do ?**

 A: First please make sure it is really a bug:
    read the documentation, check, double check.
    Then you can write a description of the problem, with a minimal program
    source code and data to replicate it.
    Then you can jump to the CONTACTS details section.


 Q: **Is it possible to build matrices of, say, `long double` or
    `long double complex` or `int` or `short int` ?**

 A: Yes. Invoke the configure script accordingly, e.g.:
      `--enable-matrix-types="long double"` or
      `--enable-matrix-types="double,long double,double complex"`
    If this breaks code compilation, feel free to contact the author
    (see the CONTACTS section).
    Note that some combinations may break `make qtests` or other test recipes.


 Q: **Is there a way to compare the performance of this library to some other
    high performance libraries ?**

 A: If you build `rsbench` with support for the Intel MKL library, then you
    can do performance comparisons with e.g.:
    `# ./rsbench -oa -Ob -qH -R --gen-diag 100 --compare-competitors --verbose`
    or use the following script:
    `# bench/dense.sh ' '`
    Or even better, check out the `--write-performance-record` feature.
    For details see the output of:
    `# rsbench -oa -Ob --help`


 Q: **Is there a non-threaded (serial) version of librsb ?**

 A: Yes: you can configure the library to work serially (with no OpenMP).
    See `./configure --help`. 


 Q: **Is this library thread-safe ?**

 A: Probably yes: no static buffers are being used, and reentrant C standard
    library functions are invoked.


 Q: **Does the librsb library run on GPUs?**

 A: Not yet.


 Q: **I built and compiled the code without enabling any BLAS type (S,D,C,Z), 
     and both `make qtests` and `make tests` ran successfully outside the
     `./examples` directory, but `make tests` breaks within `./examples` 
     directory.**

 A: Well, the tests passed because the examples testing was simply skipped.
    The example programs need at least one of these types to work.


 Q: **At build time I get many "unused variable" warnings. Why ?**

 A: librsb accommodates many code generation and build time configuration
    options. Some combinations may turn off compilation of certain parts of the
    code, leading some variables to be unused.


 Q: **Are there papers to read about the RSB format and algorithms ?**

 A: Yes, the following:

 *  Michele Martone, Simone Bacchio.
    Portable performance on multi-threaded Sparse BLAS operations with PyRSB
    Proceedings of SciPy 2021 (Scientific Python Conference).
    https://doi.org/10.25080/majora-1b6fd038-00e

 *  Michele Martone.
    Efficient Multithreaded Untransposed, Transposed or Symmetric Sparse
    Matrix-Vector Multiplication with the Recursive Sparse Blocks Format.
    Parallel Computing 40(7): 251-270 (2014).
    http://dx.doi.org/10.1016/j.parco.2014.03.008

 *  Michele Martone.
    Cache and Energy Efficiency of Sparse Matrix-Vector Multiplication for
    Different BLAS Numerical Types with the RSB Format.
    Proceedings of the ParCo 2013 conference, September 2013, Munich, Germany.
    PARCO 2013: 193-202.
    http://dx.doi.org/10.3233/978-1-61499-381-0-193

 *  Michele Martone, Marcin Paprzycki, Salvatore Filippone.
    An Improved Sparse Matrix-Vector Multiply Based on Recursive Sparse Blocks  
    Layout.
    LSSC 2011: 606-613.
    http://dx.doi.org/10.1007/978-3-642-29843-1_69

 *  Michele Martone, Salvatore Filippone, Salvatore Tucci, Marcin Paprzycki,
    Maria Ganzha.
    Utilizing Recursive Storage in Sparse Matrix-Vector.
    Multiplication - Preliminary Considerations. CATA 2010: 300-305
    
 *  Michele Martone, Salvatore Filippone, Marcin Paprzycki, Salvatore Tucci.
    Assembling Recursively Stored Sparse Matrices. IMCSIT 2010: 317-325.
    http://www.proceedings2010.imcsit.org/pliks/205.pdf

 *  Michele Martone, Salvatore Filippone, Pawel Gepner, Marcin Paprzycki,
    Salvatore Tucci.
    Use of Hybrid Recursive CSR/COO Data Structures in Sparse Matrices-Vector
    Multiplication.
    IMCSIT 2010: 327-335.
    http://dx.doi.org/10.1109/SYNASC.2010.72

 *  Michele Martone, Salvatore Filippone, Marcin Paprzycki, Salvatore Tucci.
    On BLAS Operations with Recursively Stored Sparse Matrices.
    SYNASC 2010: 49-56.
    http://dx.doi.org/10.1109/SYNASC.2010.72

 *  Michele Martone, Salvatore Filippone, Marcin Paprzycki, Salvatore Tucci.
    On the Usage of 16 Bit Indices in Recursively Stored Sparse Matrices.
    SYNASC 2010: 57-64.
    http://dx.doi.org/10.1109/SYNASC.2010.77


 Q: **I have make-related problems on my FreeBSD/OpenBSD/NetBSD.
    What should I do ?**

 A: Did you try using GNU Make implementation via
    e.g.: `./configure MAKE=gmake ...`?


 Q: **Running `make` keep crashing when recreating rsb.F90!
      And I do not need Fortran..**

 A: Ok, disable it: `./configure FC=' ' ...`.


 Q: **I keep getting C++ compile or link problems.
     How do I do?**

 A: Use: `./configure CXX=' ' ...`.
    This turns off rsb_spmm/usmm faster kernels, and several test programs.


 Q: **I have M4-related problems on IBM SP5/SP6/... . What should I do ?**

 A: A fix is to use a GNU M4 implementation 
    e.g.: `./configure M4=/opt/freeware/bin/m4 ...` (or `M4=gm4`)
    BTW, if it's an old POWER machine consider donating it to a computer museum,
    like https://museo.freaknet.org/
   

 Q: **Can I skip the OpenMP flags guessing mechanism and specify flags my own?**

 A: Yes, e.g.: `--enable-openmp 'ac_cv_prog_c_openmp=-DMY_OMP_FLAGS'`
    If you use e.g. `OPENMP_CFLAGS=-DMY_OMP_FLAGS` it won't skip the tests, and
    may introduce unwanted flags.


POSSIBLE FUTURE ENHANCEMENTS
--------------------------------------------------------------------------------

 * auxiliary functions for numerical vectors
 * CSC,BCSR,BCSC and other block-level formats
 * performance prediction/estimation facilities (experimental)
 * types of the blocks, nonzeroes, and coordinates indices can be user specified
 * automatic matrix blocking selection (for BCSR/BCSC) 
 * an arbitrary subset of block size kernels can be specified to be generated
 * recursive storage variants of blocked formats (non uniform blocking)
 * more auto-tuning and prediction control


ABOUT THE INTERNALS
--------------------------------------------------------------------------------

 The following good practices are being followed during development of librsb:

 - only symbols beginning with `rsb_` or `blas_` or `BLAS_` are being exported
 - internal functions are usually prefixed by `rsb__`
 - no library internal function is expected to call any API function


BUGS
--------------------------------------------------------------------------------

 If you encounter any bug (e.g.: mismatch of library/program behaviour and
 documentation, please let me know about it by sending me (see CONTACTS) all
 relevant information (code snippet, originating data/matrix, `config.log` ), in
 such a way that I can replicate the bug behaviour on my machines.
 If the bug occurred when using rsb interfaced to some proprietary library,
 please make sure the bug is in librsb.

 It may be of great help to you to build the library with the debug compile
 options on (e.g.: `CFLAGS='-O0 -ggdb'`), and with appropriate library verbosity
 levels, e.g. (`--enable-internals-error-verbosity=1` and
  `--enable-interface-error-verbosity=1` options to configure) to better 
 understand the program behaviour before sending a report.

 Make sure you have the latest version of the library when reporting a bug. 


CONTACTS
--------------------------------------------------------------------------------

 You are welcome to contact the librsb author:

  Michele Martone `&lt;michelemartone AT users DOT sourceforge DOT net&gt;`
 
 Please specify "librsb" in the "Subject:" line of your emails.

 More information and downloads on  http://sourceforge.net/projects/librsb

 Mailing list: https://lists.sourceforge.net/lists/listinfo/librsb-users
 

CREDITS	(in alphabetical order)
--------------------------------------------------------------------------------

For librsb-1.3:

 * Juan Durillo Barrionuevo patiently tested and helped smoothing the build
   system on the Mac OS.
 * Salvatore Cielo provided testing on the Mac OS.
 * Rafael Laboissiere for continued help in aspects of build, documentation,
   testing and distribution.
 * Markus Muetzel suggested use of putenv() as Windows alternative to setenv().
 * Nisarg Patel provided testing on the Mac OS.
 * Matthieu A. Simonin for testing, discussion and suggestions.

For librsb-1.2:

 * Marco Atzeri provided testing, patches to build librsb under cygwin over
   nearly each release, and spotted a few bugs.
 * Fabio Cassini spotted an unintended conversion via sparsersb and +.
 * John Donoghue spotted a rendering corner case bug.
 * Sebastian Koenig spotted a computational bug in -rc6.
 * Rafael Laboissiere helped a lot improving the documentation and the build 
   system.
 * Mu-Chu Lee provided a patch to fix sorting code crashing with &gt; 10^9 nnz.
 * Constanza Manassero spotted an inconsistency in the usmm/ussm interface.
 * Markus Muetzel helped debugging rsb_mtx_rndr().
 * Dmitri Sergatskov spotted a double free in rsb_mtx_rndr() and convinced about
   the necessity of sanitizing memory usage.

For librsb-1.1:

 * Gilles Gouaillardet provided a patch for OpenMP-encapsulated I/O.
 * Marco Restelli provided with testing and detailed comments and suggestions.

For librsb-1.0:

 * Francis Casson helped with testing and documentation reviewing during 
   the first release.
 * Nitya Hariharan helped revising early versions of the documentation.


ACKNOWLEDGEMENTS
--------------------------------------------------------------------------------

  In 2019-2022, librsb has been developed under the PRACE-6IP-WP8 (GRANT
  AGREEMENT NUMBER 823767 -- PRACE-6IP) EU project LyNcs (partners:
  Computation-based Science and Technology Research Centre (CaSToRC) of The
  Cyprus Institute and Inria).


LICENSE
--------------------------------------------------------------------------------

 This software is distributed under the terms of the Lesser GNU Public License
 version 3 (LGPLv3) or later.
 See the COPYING file for a copy of the LGPLv3.

 librsb is free software.
 To support it, consider writing to the author and acknowledging use of librsb 
 in your publications.
 All that would be very appreciated.


--------------------------------------------------------------------------------
</pre><p><a class="anchor" id="examples_section"></a></p>
<p>For a quick startup, consider the following three example programs.</p>
<p>The first, using the RSB interface (for native C++, please see the optional <a class="el" href="example_8cpp.html" title="C++ example based on &lt;rsb.hpp&gt; using RsbMatrix.spmm(). ">rsblib/examples/example.cpp</a>): </p><div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">Copyright (C) 2008-2021 Michele Martone</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">This file is part of librsb.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">librsb is free software; you can redistribute it and/or modify it</span></div><div class="line"><span class="comment">under the terms of the GNU Lesser General Public License as published</span></div><div class="line"><span class="comment">by the Free Software Foundation; either version 3 of the License, or</span></div><div class="line"><span class="comment">(at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">librsb is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div><div class="line"><span class="comment">FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div><div class="line"><span class="comment">License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">License along with librsb; see the file COPYING.</span></div><div class="line"><span class="comment">If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">*/</span><span class="comment"></span></div><div class="line"><span class="comment">/*!</span></div><div class="line"><span class="comment"> \ingroup rsb_doc_examples</span></div><div class="line"><span class="comment"> @file</span></div><div class="line"><span class="comment"> @author Michele Martone</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> @brief A first &quot;hello RSB&quot; example C program based on &lt;rsb.h&gt;.</span></div><div class="line"><span class="comment">   Uses #rsb_lib_set_opt(), #rsb_mtx_get_info_str().</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> \include hello.c</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rsb_8h.html">rsb.h</a>&gt;</span>        <span class="comment">/* librsb header to include */</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span>      <span class="comment">/* printf() */</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="assemble_8cpp.html#a8216c1645620cdb2f629cde3ac02ffef">main</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * <span class="keyword">const</span> argv[])</div><div class="line">{<span class="comment"></span></div><div class="line"><span class="comment">        /*!</span></div><div class="line"><span class="comment">          A Hello-RSB program.</span></div><div class="line"><span class="comment">         </span></div><div class="line"><span class="comment">          This program shows how to use the rsb.h interface correctly to:</span></div><div class="line"><span class="comment">         </span></div><div class="line"><span class="comment">          - initialize the library using #rsb_lib_init()</span></div><div class="line"><span class="comment">          - set library options using #rsb_lib_set_opt()</span></div><div class="line"><span class="comment">          - revert such changes </span></div><div class="line"><span class="comment">          - allocate (build) a single sparse matrix in the RSB format</span></div><div class="line"><span class="comment">            using #rsb_mtx_alloc_from_coo_const()</span></div><div class="line"><span class="comment">          - prints information obtained via #rsb_mtx_get_info_str()</span></div><div class="line"><span class="comment">          - multiply the matrix times a vector using #rsb_spmv()</span></div><div class="line"><span class="comment">          - deallocate the matrix using #rsb_mtx_free() </span></div><div class="line"><span class="comment">          - finalize the library using #rsb_lib_exit()</span></div><div class="line"><span class="comment">         </span></div><div class="line"><span class="comment">          In this example, we use #RSB_DEFAULT_TYPE as matrix type.</span></div><div class="line"><span class="comment">          This type depends on what was configured at library build time.</span></div><div class="line"><span class="comment">         * */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#ac6a4411e32793f5c150c6ab3c6f7e14e">rsb_blk_idx_t</a> bs = <a class="code" href="rsb_8h.html#a3579d00f3b97cd569707f7c62e462322">RSB_DEFAULT_BLOCKING</a>;</div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#ac6a4411e32793f5c150c6ab3c6f7e14e">rsb_blk_idx_t</a> brA = bs, bcA = bs;</div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb__types_8h.html#aa5e96f00841ec8f4f3ca1ff0bf1b5bbd">RSB_DEFAULT_TYPE</a> one = 1;</div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#ac0f6a03345c8874f6e50f0ed033d984b">rsb_type_t</a> typecode = <a class="code" href="rsb__types_8h.html#a56fc5ef14266266227797621e0a1e217">RSB_NUMERICAL_TYPE_DEFAULT</a>;</div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#a46b3366e54a5b4dda754a6ace22264df">rsb_nnz_idx_t</a> nnzA = 4;           <span class="comment">/* matrix nonzeroes count */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#a4874ba61df0ff15b4395278496f83a5d">rsb_coo_idx_t</a> nrA = 3;            <span class="comment">/* matrix rows count */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#a4874ba61df0ff15b4395278496f83a5d">rsb_coo_idx_t</a> ncA = 3;            <span class="comment">/* matrix columns count */</span></div><div class="line">        <span class="comment">/* nonzero row indices coordinates: */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#a4874ba61df0ff15b4395278496f83a5d">rsb_coo_idx_t</a> IA[] = {0,1,2,2};</div><div class="line">        <span class="comment">/* nonzero column indices coordinates: */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb_8h.html#a4874ba61df0ff15b4395278496f83a5d">rsb_coo_idx_t</a> JA[] = {0,1,2,2};</div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb__types_8h.html#aa5e96f00841ec8f4f3ca1ff0bf1b5bbd">RSB_DEFAULT_TYPE</a> VA[] = {11,22,32,1};<span class="comment">/* values of nonzeroes */</span></div><div class="line">        <a class="code" href="rsb__types_8h.html#aa5e96f00841ec8f4f3ca1ff0bf1b5bbd">RSB_DEFAULT_TYPE</a> X[] = { 0, 0, 0 };     <span class="comment">/* X vector&#39;s array */</span></div><div class="line">        <span class="keyword">const</span> <a class="code" href="rsb__types_8h.html#aa5e96f00841ec8f4f3ca1ff0bf1b5bbd">RSB_DEFAULT_TYPE</a> B[] = { -1, -2, -5 }; <span class="comment">/* B vector&#39;s array */</span></div><div class="line">        <span class="keywordtype">char</span> ib[200];</div><div class="line">        <span class="keyword">struct </span>rsb_mtx_t *mtxAp = NULL; <span class="comment">/* matrix structure pointer */</span></div><div class="line">        <a class="code" href="rsb_8h.html#a640e84bcc5268cd92d5d31fd6ac321b8">rsb_err_t</a> errval = <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>;</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Hello, RSB!\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;Initializing the library...\n&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span>((errval = <a class="code" href="group__rsb__doc__rsb.html#gaf2b874d9f117ee6a6899634472b17946">rsb_lib_init</a>(<a class="code" href="rsb_8h.html#add105c42e570c5c269680d437f8c51e2">RSB_NULL_INIT_OPTIONS</a>)) != </div><div class="line">                        <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;Error initializing the library!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly initialized the library.\n&quot;</span>);</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Attempting to set the&quot;</span></div><div class="line">               <span class="stringliteral">&quot; RSB_IO_WANT_EXTRA_VERBOSE_INTERFACE library option.\n&quot;</span>);</div><div class="line">        {</div><div class="line">                <a class="code" href="rsb_8h.html#aefcdc7de885ab34a89a0d36470e11deb">rsb_int_t</a> evi=1; </div><div class="line"></div><div class="line">                <span class="comment">/* Setting a single optional library parameter. */</span></div><div class="line">                errval = <a class="code" href="group__rsb__doc__rsb.html#ga2a08c5a23f3999fe8cf36440680e4a05">rsb_lib_set_opt</a>(</div><div class="line">                        <a class="code" href="group__rsb__doc__rsb.html#ggae0bada88731b01751401847d60110fb6a56c0c6849135ce5fa9edd7907ab3e0cb">RSB_IO_WANT_EXTRA_VERBOSE_INTERFACE</a>, &amp;evi);</div><div class="line">                <span class="keywordflow">if</span>(errval != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>)</div><div class="line">                {</div><div class="line">                        <span class="keywordtype">char</span> errbuf[256];</div><div class="line">                        <a class="code" href="group__rsb__doc__rsb.html#ga28710b8dade48738ea8e075aa1a3d262">rsb_strerror_r</a>(errval,&amp;errbuf[0],<span class="keyword">sizeof</span>(errbuf));</div><div class="line">                        printf(<span class="stringliteral">&quot;Failed setting the&quot;</span></div><div class="line">                        <span class="stringliteral">&quot; RSB_IO_WANT_EXTRA_VERBOSE_INTERFACE&quot;</span></div><div class="line">                        <span class="stringliteral">&quot; library option (reason string:\n%s).\n&quot;</span>,errbuf);</div><div class="line">                        <span class="keywordflow">if</span>(errval&amp;<a class="code" href="rsb_8h.html#a4d8eb05488b681b75449f64c418b8893">RSB_ERRS_UNSUPPORTED_FEATURES</a>)</div><div class="line">                        {</div><div class="line">                          printf(<span class="stringliteral">&quot;This error may be safely ignored.\n&quot;</span>);</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                        {</div><div class="line">                          printf(<span class="stringliteral">&quot;Some unexpected error occurred!\n&quot;</span>);</div><div class="line">                          <span class="keywordflow">goto</span> err;</div><div class="line">                        }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Setting back the &quot;</span></div><div class="line">                                <span class="stringliteral">&quot;RSB_IO_WANT_EXTRA_VERBOSE_INTERFACE&quot;</span></div><div class="line">                                <span class="stringliteral">&quot; library option.\n&quot;</span>);</div><div class="line">                        evi = 0;</div><div class="line">                        errval = <a class="code" href="group__rsb__doc__rsb.html#ga2a08c5a23f3999fe8cf36440680e4a05">rsb_lib_set_opt</a>(<a class="code" href="group__rsb__doc__rsb.html#ggae0bada88731b01751401847d60110fb6a56c0c6849135ce5fa9edd7907ab3e0cb">RSB_IO_WANT_EXTRA_VERBOSE_INTERFACE</a>,</div><div class="line">                                        &amp;evi);</div><div class="line">                        errval = <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>;</div><div class="line">                }</div><div class="line">        }</div><div class="line"></div><div class="line">        mtxAp = <a class="code" href="group__rsb__doc__rsb.html#ga86c1b0d0586f817ee31ca1caa3fee9be">rsb_mtx_alloc_from_coo_const</a>(</div><div class="line">                VA,IA,JA,nnzA,typecode,nrA,ncA,brA,bcA,</div><div class="line">                <a class="code" href="rsb_8h.html#a0ea7640214ee34c87e483c475b15827d">RSB_FLAG_NOFLAGS</a>    <span class="comment">/* default format will be chosen */</span></div><div class="line">                |<a class="code" href="rsb_8h.html#afd1b39c625f4249cd32fccea38957f97">RSB_FLAG_DUPLICATES_SUM</a><span class="comment">/* duplicates will be summed */</span></div><div class="line">                        ,&amp;errval);</div><div class="line">        <span class="keywordflow">if</span>((!mtxAp) || (errval != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>))</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;Error while allocating the matrix!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly allocated a matrix.\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;Summary information of the matrix:\n&quot;</span>);</div><div class="line">        <span class="comment">/* print out the matrix summary information  */</span></div><div class="line">        <a class="code" href="group__rsb__doc__rsb.html#ga2b7d51b9822f73d2fe7fcf5b9d0be1e9">rsb_mtx_get_info_str</a>(mtxAp,<span class="stringliteral">&quot;RSB_MIF_MATRIX_INFO__TO__CHAR_P&quot;</span>,</div><div class="line">                        ib,<span class="keyword">sizeof</span>(ib));</div><div class="line">        printf(<span class="stringliteral">&quot;%s&quot;</span>,ib);</div><div class="line">        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>((errval = </div><div class="line">                <a class="code" href="group__rsb__doc__rsb.html#ga4a16a82d289c76a437915db449553d4d">rsb_spmv</a>(<a class="code" href="rsb__types_8h.html#a9673f34330af77b1c0fd4a585e0c62cc">RSB_TRANSPOSITION_N</a>,&amp;one,mtxAp,B,1,&amp;one,X,1))</div><div class="line">                        != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a> )</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;Error performing a multiplication!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly performed a SPMV.\n&quot;</span>);</div><div class="line">        <a class="code" href="group__rsb__doc__rsb.html#gab64a020286a8b58d23d84d4512bd9132">rsb_mtx_free</a>(mtxAp);</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly freed the matrix.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span>((errval = <a class="code" href="group__rsb__doc__rsb.html#ga86db30487afe975ed18a7aa6ee0db81d">rsb_lib_exit</a>(<a class="code" href="rsb_8h.html#a2234a5e51156de6c95c3f8c2951ae09f">RSB_NULL_EXIT_OPTIONS</a>))</div><div class="line">                        != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;Error finalizing the library!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly finalized the library.\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;Program terminating with no error.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">err:</div><div class="line">        <a class="code" href="group__rsb__doc__rsb.html#gab660cf8aff876ae88b59c7a22ddfc912">rsb_perror</a>(NULL,errval);</div><div class="line">        printf(<span class="stringliteral">&quot;Program terminating with error.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p>The second, using the Sparse BLAS interface: </p><div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">Copyright (C) 2008-2021 Michele Martone</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">This file is part of librsb.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">librsb is free software; you can redistribute it and/or modify it</span></div><div class="line"><span class="comment">under the terms of the GNU Lesser General Public License as published</span></div><div class="line"><span class="comment">by the Free Software Foundation; either version 3 of the License, or</span></div><div class="line"><span class="comment">(at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">librsb is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div><div class="line"><span class="comment">FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div><div class="line"><span class="comment">License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">License along with librsb; see the file COPYING.</span></div><div class="line"><span class="comment">If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">*/</span><span class="comment"></span></div><div class="line"><span class="comment">/*!</span></div><div class="line"><span class="comment"> \ingroup rsb_doc_examples</span></div><div class="line"><span class="comment"> @file</span></div><div class="line"><span class="comment"> @author Michele Martone</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> @brief A first C &quot;hello RSB&quot; example program using</span></div><div class="line"><span class="comment">        a Sparse BLAS interface and &lt;rsb.h&gt;.</span></div><div class="line"><span class="comment">        Uses #BLAS_duscr_begin(), #BLAS_ussp(), #BLAS_usgp(),</span></div><div class="line"><span class="comment">        #BLAS_duscr_insert_entries(), #BLAS_duscr_end(),</span></div><div class="line"><span class="comment">        #BLAS_dusget_element(),#BLAS_dusmv(),#BLAS_usds().</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> \include hello-spblas.c</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rsb_8h.html">rsb.h</a>&gt;</span>        <span class="comment">/* for rsb_lib_init */</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="blas__sparse_8h.html">blas_sparse.h</a>&gt;</span>        <span class="comment">/* Sparse BLAS on the top of librsb */</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span>      <span class="comment">/* printf */</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="assemble_8cpp.html#a8216c1645620cdb2f629cde3ac02ffef">main</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * <span class="keyword">const</span> argv[])</div><div class="line">{<span class="comment"></span></div><div class="line"><span class="comment">        /*!</span></div><div class="line"><span class="comment">         * A Hello/Sparse BLAS program.</span></div><div class="line"><span class="comment">         *</span></div><div class="line"><span class="comment">         * This program shows how to use the blas_sparse.h</span></div><div class="line"><span class="comment">         * interface correctly to:</span></div><div class="line"><span class="comment">         *</span></div><div class="line"><span class="comment">         * - initialize the library using #rsb_lib_init()</span></div><div class="line"><span class="comment">         * - allocate (build) a single sparse matrix in the RSB</span></div><div class="line"><span class="comment">         *   format using #BLAS_duscr_begin()/#BLAS_duscr_insert_entries()</span></div><div class="line"><span class="comment">         *   /#BLAS_duscr_end()</span></div><div class="line"><span class="comment">         * - extract one matrix element with #BLAS_dusget_element()</span></div><div class="line"><span class="comment">         * - multiply the matrix times a vector using #BLAS_dusmv()</span></div><div class="line"><span class="comment">         * - deallocate the matrix using #BLAS_usds() </span></div><div class="line"><span class="comment">         * - finalize the library using</span></div><div class="line"><span class="comment">         *   #rsb_lib_exit(#RSB_NULL_EXIT_OPTIONS) </span></div><div class="line"><span class="comment">        */</span></div><div class="line"><span class="preprocessor">#ifndef RSB_NUMERICAL_TYPE_DOUBLE   </span></div><div class="line">        printf(<span class="stringliteral">&quot;&#39;double&#39; type configured out.&quot;</span></div><div class="line">        <span class="stringliteral">&quot; Please reconfigure the library with it and recompile.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><span class="preprocessor">#else </span><span class="comment">/* RSB_NUMERICAL_TYPE_DOUBLE */</span><span class="preprocessor"></span></div><div class="line">        <a class="code" href="blas__sparse_8h.html#a6f56456b01e0cc6b25b81201aa67c163">blas_sparse_matrix</a> A = <a class="code" href="blas__sparse_8h.html#a7cb10fb1b47b79ef278d6f09d571bd06a51022d3d696b9aee38d51040a5b01da7">blas_invalid_handle</a>; <span class="comment">/* handle for A */</span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> nnz = 4;      <span class="comment">/* number of nonzeroes of matrix A */</span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span>  nr = 3;      <span class="comment">/* number of A&#39;s rows */</span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span>  nc = 3;      <span class="comment">/* number of A&#39;s columns */</span></div><div class="line">        <span class="comment">/* A&#39;s nonzero elements row indices (coordinates): */</span></div><div class="line"><span class="preprocessor">#ifdef RSB_WANT_LONG_IDX_TYPE </span></div><div class="line">        <span class="keyword">const</span> int64_t IA[] = { 0, 1, 2, 2 };</div><div class="line"><span class="preprocessor">#else </span><span class="comment">/* RSB_WANT_LONG_IDX_TYPE */</span><span class="preprocessor"></span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span>   IA[] = { 0, 1, 2, 2 };</div><div class="line"><span class="preprocessor">#endif </span><span class="comment">/* RSB_WANT_LONG_IDX_TYPE */</span><span class="preprocessor"></span></div><div class="line">        <span class="comment">/* A&#39;s nonzero elements column indices (coordinates): */</span></div><div class="line"><span class="preprocessor">#ifdef RSB_WANT_LONG_IDX_TYPE </span></div><div class="line">        <span class="keyword">const</span> int64_t JA[] = { 0, 1, 0, 2 };</div><div class="line"><span class="preprocessor">#else </span><span class="comment">/* RSB_WANT_LONG_IDX_TYPE */</span><span class="preprocessor"></span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span>   JA[] = { 0, 1, 0, 2 };</div><div class="line"><span class="preprocessor">#endif </span><span class="comment">/* RSB_WANT_LONG_IDX_TYPE */</span><span class="preprocessor"></span></div><div class="line">        <span class="comment">/* A&#39;s nonzero values (matrix coefficients): */</span></div><div class="line">        <span class="keywordtype">double</span> VA[] = { 11.0, 22.0, 13.0, 33.0  };</div><div class="line">        <span class="comment">/* the X vector&#39;s array: */</span></div><div class="line">        <span class="keywordtype">double</span> X[] = { 0.0, 0.0, 0.0 };</div><div class="line">        <span class="comment">/* the B vector&#39;s array: */</span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> B[] = { -1.0, -2.0, -2.0 };</div><div class="line">        <span class="comment">/* the (known) result array: */</span></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> AB[] = { 11.0+26.0, 44.0, 66.0+13.0 };</div><div class="line">        <span class="comment">/* rsb error variable: */</span></div><div class="line">        <a class="code" href="rsb_8h.html#a640e84bcc5268cd92d5d31fd6ac321b8">rsb_err_t</a> errval = <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>;</div><div class="line">        <span class="keywordtype">int</span> i;</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Hello, RSB!\n&quot;</span>);</div><div class="line">        <span class="comment">/* initialize the library */</span></div><div class="line">        <span class="keywordflow">if</span>((errval = <a class="code" href="group__rsb__doc__rsb.html#gaf2b874d9f117ee6a6899634472b17946">rsb_lib_init</a>(<a class="code" href="rsb_8h.html#add105c42e570c5c269680d437f8c51e2">RSB_NULL_INIT_OPTIONS</a>)) </div><div class="line">                        != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>)</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly initialized the library.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">/* initialize a matrix descriptor */</span></div><div class="line">        A = <a class="code" href="group__rsb__doc__sparse__blas.html#gac931dcb1129ee3016ab82602c3d14fee">BLAS_duscr_begin</a>(nr,nc);</div><div class="line">        <span class="keywordflow">if</span>( A == <a class="code" href="blas__sparse_8h.html#a7cb10fb1b47b79ef278d6f09d571bd06a51022d3d696b9aee38d51040a5b01da7">blas_invalid_handle</a> )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        </div><div class="line">        <span class="comment">/* specify properties (e.g.: symmetry)*/</span></div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="blas__sparse_8h.html#a6719ae77dfef6d6dd0790e34a65c1924">BLAS_ussp</a>(A,<a class="code" href="blas__sparse_8h.html#a7da08ccc1c4c7f5ff40768d502a6e63baba96b7c19a0ccfe3be9d78cb27690487">blas_lower_symmetric</a>) != 0 )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* get properties (e.g.: symmetry) */</span></div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="blas__sparse_8h.html#a5eec91b6d95962811bd9cb4e37266214">BLAS_usgp</a>(A,<a class="code" href="blas__sparse_8h.html#a7da08ccc1c4c7f5ff40768d502a6e63baba96b7c19a0ccfe3be9d78cb27690487">blas_lower_symmetric</a>) != 1 )</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;Symmetry property non set ?!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* insert the nonzeroes (here, all at once) */</span></div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="group__rsb__doc__sparse__blas.html#gae0683bc8f0af5dd3e53b964190f9e1b4">BLAS_duscr_insert_entries</a>(A, nnz, VA, IA, JA)</div><div class="line">                        == <a class="code" href="blas__sparse_8h.html#a7cb10fb1b47b79ef278d6f09d571bd06a51022d3d696b9aee38d51040a5b01da7">blas_invalid_handle</a>)</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* finalize (allocate) the matrix build  */</span></div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="group__rsb__doc__sparse__blas.html#ga5d9ce97bf054b1e3750eaae5d4e6c335">BLAS_duscr_end</a>(A) == <a class="code" href="blas__sparse_8h.html#a7cb10fb1b47b79ef278d6f09d571bd06a51022d3d696b9aee38d51040a5b01da7">blas_invalid_handle</a> )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly allocated a matrix.\n&quot;</span>);</div><div class="line"></div><div class="line">        VA[0] = 0.0;</div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="group__rsb__doc__sparse__blas.html#ga7cdfc09a860b29267539c4868f41ec51">BLAS_dusget_element</a>(A, IA[0], JA[0], &amp;VA[0]) )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* a check */</span></div><div class="line">        <span class="keywordflow">if</span>( VA[0] != 11.0 )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* compute X = X + (-1) * A * B   */</span></div><div class="line">        <span class="keywordflow">if</span>(<a class="code" href="group__rsb__doc__sparse__blas.html#gad018cf218c2c938bb5cf4577f1b53319">BLAS_dusmv</a>(<a class="code" href="blas__sparse_8h.html#a23e5e138364c80074ac014a3dfd346b7a60c827bef60beeea296c26486e28d85f">blas_no_trans</a>,-1,A,B,1,X,1))</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>( i = 0 ; i &lt; nc; ++i )</div><div class="line">                <span class="keywordflow">if</span>( X[i] != AB[i] )</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Computed SPMV result seems wrong. Terminating.\n&quot;</span>);</div><div class="line">                        <span class="keywordflow">goto</span> err;</div><div class="line">                }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly performed a SPMV.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">/* deallocate matrix A */</span></div><div class="line">        <span class="keywordflow">if</span>( <a class="code" href="group__rsb__doc__sparse__blas.html#ga8b0cca8196f40f7b55084a978b40717f">BLAS_usds</a>(A) )</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly freed the matrix.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">/* finalize the library */</span></div><div class="line">        <span class="keywordflow">if</span>((errval = <a class="code" href="group__rsb__doc__rsb.html#ga86db30487afe975ed18a7aa6ee0db81d">rsb_lib_exit</a>(<a class="code" href="rsb_8h.html#a2234a5e51156de6c95c3f8c2951ae09f">RSB_NULL_EXIT_OPTIONS</a>))</div><div class="line">                        != <a class="code" href="rsb_8h.html#a1ad3f986b2e84249785751bf42ff3f8a">RSB_ERR_NO_ERROR</a>)</div><div class="line">        {</div><div class="line">                <span class="keywordflow">goto</span> err;</div><div class="line">        }</div><div class="line">        printf(<span class="stringliteral">&quot;Correctly finalized the library.\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;Program terminating with no error.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">err:</div><div class="line">        <a class="code" href="group__rsb__doc__rsb.html#gab660cf8aff876ae88b59c7a22ddfc912">rsb_perror</a>(NULL,errval);</div><div class="line">        printf(<span class="stringliteral">&quot;Program terminating with error.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line"><span class="preprocessor">#endif </span><span class="comment">/* RSB_NUMERICAL_TYPE_DOUBLE */</span><span class="preprocessor"></span></div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p>For more, see the <a class="el" href="group__rsb__doc__examples.html">Example programs and code</a> section. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
